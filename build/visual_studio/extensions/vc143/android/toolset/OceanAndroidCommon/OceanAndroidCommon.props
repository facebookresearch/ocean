<?xml version="1.0" encoding="utf-8"?>
<!--
  Ocean Android Extension - Common Properties
  Shared property definitions for Android Application and Java Library projects.
  Imported by project files via registry path or development fallback.
-->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <!-- Android SDK Path Resolution -->
  <!-- Priority: ANDROID_HOME > ANDROID_SDK_ROOT > default Android Studio location -->
  <PropertyGroup>
    <AndroidSdkPath Condition="'$(AndroidSdkPath)' == ''">$(ANDROID_HOME)</AndroidSdkPath>
    <AndroidSdkPath Condition="'$(AndroidSdkPath)' == ''">$(ANDROID_SDK_ROOT)</AndroidSdkPath>
    <AndroidSdkPath Condition="'$(AndroidSdkPath)' == ''">$(LOCALAPPDATA)\Android\Sdk</AndroidSdkPath>
  </PropertyGroup>

  <!-- Java Home Detection -->
  <!-- Requires Java 17+ for AGP 8.x -->
  <!-- Priority: 1) OCEAN_JAVA_HOME, 2) Auto-detect JDK 17-21, 3) Android Studio JBR, 4) JAVA_HOME -->
  <!-- Note: JDK 25+ is NOT supported by Gradle yet -->
  <PropertyGroup>
    <JavaHome Condition="'$(JavaHome)' == ''">$(OCEAN_JAVA_HOME)</JavaHome>
    <!-- Auto-detect common JDK installations (JDK 17-21 supported) -->
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Java\jdk-21')">$(ProgramFiles)\Java\jdk-21</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Java\jdk-17')">$(ProgramFiles)\Java\jdk-17</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Eclipse Adoptium\jdk-21')">$(ProgramFiles)\Eclipse Adoptium\jdk-21</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Eclipse Adoptium\jdk-17')">$(ProgramFiles)\Eclipse Adoptium\jdk-17</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Microsoft\jdk-21')">$(ProgramFiles)\Microsoft\jdk-21</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Microsoft\jdk-17')">$(ProgramFiles)\Microsoft\jdk-17</JavaHome>
    <!-- Android Studio bundled JBR -->
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(LOCALAPPDATA)\Programs\Android Studio\jbr')">$(LOCALAPPDATA)\Programs\Android Studio\jbr</JavaHome>
    <JavaHome Condition="'$(JavaHome)' == '' AND Exists('$(ProgramFiles)\Android\Android Studio\jbr')">$(ProgramFiles)\Android\Android Studio\jbr</JavaHome>
    <!-- Fall back to JAVA_HOME (may be incompatible version) -->
    <JavaHome Condition="'$(JavaHome)' == ''">$(JAVA_HOME)</JavaHome>
  </PropertyGroup>

  <!-- Output Directory Defaults -->
  <!-- Defined before Gradle properties since they depend on $(IntDir). -->
  <!-- Conditional so projects or user .props files can override. -->
  <PropertyGroup>
    <IntDir Condition="'$(IntDir)' == ''">$(MSBuildProjectDirectory)\obj\$(Platform)\$(Configuration)\</IntDir>
    <OutDir Condition="'$(OutDir)' == ''">$(MSBuildProjectDirectory)\bin\$(Platform)\$(Configuration)\</OutDir>
  </PropertyGroup>

  <!-- Configuration Defaults -->
  <!-- ConfigurationType is set per-project in Globals; CharacterSet is universal. -->
  <PropertyGroup>
    <CharacterSet Condition="'$(CharacterSet)' == '' OR '$(CharacterSet)' == 'NotSet'">Unicode</CharacterSet>
  </PropertyGroup>

  <!-- Gradle Infrastructure Properties -->
  <!-- Shared defaults for Android Application and Java Library projects. -->
  <!-- Each property is conditional so individual projects can override if needed. -->
  <PropertyGroup>
    <JavaStagingDir Condition="'$(JavaStagingDir)' == ''">$(IntDir)java-staging</JavaStagingDir>
    <GradleProjectDir Condition="'$(GradleProjectDir)' == ''">$(MSBuildProjectDirectory)\gradle</GradleProjectDir>
    <GradleWrapper Condition="'$(GradleWrapper)' == ''">$(_OceanExtensionPath)\toolset\GradleWrapper\gradlew.bat</GradleWrapper>
    <GradleCacheDir Condition="'$(GradleCacheDir)' == ''">$(IntDir)gradle-cache</GradleCacheDir>
    <GradleBuildDir Condition="'$(GradleBuildDir)' == ''">$(IntDir)gradle-build</GradleBuildDir>
    <JniLibsStagingDir Condition="'$(JniLibsStagingDir)' == ''">$(IntDir)jniLibs</JniLibsStagingDir>
  </PropertyGroup>

  <!-- Platform to Android ABI Mapping -->
  <!-- Consistent with the NDK toolset (Toolset.props). Used by App projects for jniLibs
       staging; defined universally so $(AndroidAbi) is available to all project types. -->
  <PropertyGroup Condition="'$(Platform)' == 'ARM64'">
    <AndroidAbi Condition="'$(AndroidAbi)' == ''">arm64-v8a</AndroidAbi>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)' == 'ARM'">
    <AndroidAbi Condition="'$(AndroidAbi)' == ''">armeabi-v7a</AndroidAbi>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)' == 'x64'">
    <AndroidAbi Condition="'$(AndroidAbi)' == ''">x86_64</AndroidAbi>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Platform)' == 'x86'">
    <AndroidAbi Condition="'$(AndroidAbi)' == ''">x86</AndroidAbi>
  </PropertyGroup>

</Project>
